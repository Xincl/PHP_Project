<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>服刑人员劳动报酬管理系统</title>
  <script src="../layui.js"></script>
  <link rel="stylesheet" href="../css/layui.css">
  <script src="../jquery-3.4.1.js"></script>
</head>
<body class="layui-layout-body" style="background-image: url('../images/test2.jpg');">
<div class="layui-layout layui-layout-admin">
  <div class="layui-header">
    <div class="layui-logo" style="color: white;">服刑人员劳动报酬管理系统</div>
    <ul class="layui-nav layui-layout-right">
      <li class="layui-nav-item">
        <a href="javascript:;">
          <img src="http://t.cn/RCzsdCq" class="layui-nav-img">
          贤心
        </a>
        <dl class="layui-nav-child">
          <dd><a href="">基本资料</a></dd>
          <dd><a href="">安全设置</a></dd>
        </dl>
      </li>
      <li class="layui-nav-item"><a href="">退了</a></li>
    </ul>
  </div>
  
  <div class="layui-side layui-bg-black">
    <div class="layui-side-scroll">
      <!-- 左侧导航区域（可配合layui已有的垂直导航） -->
      <ul class="layui-nav layui-nav-tree"  lay-filter="test">
        <li class="layui-nav-item" ><a href="../page/Home.html">首页</a></li>
        <li class="layui-nav-item">
          <a href="javascript:;">服刑人员信息管理</a>
          <dl class="layui-nav-child">
            <dd><a href="../page/register.html" ">注册登记</a></dd>
            <dd><a href="../page/query.html">信息查询</a></dd>
          </dl>
        </li>
        <li class="layui-nav-item"><a href="../page/salary.html" style="background-color:grey;">服刑人员报酬管理</a></li>
        <li class="layui-nav-item"><a href="../page/salaryM.html">服刑人员报酬计算</a></li>
        <li class="layui-nav-item"><a href="../page/transfer.html">服刑人员报酬转出</a></li>
      </ul>
    </div>
  </div>
  
  <div class="layui-body" >
    <!-- 内容主体区域 -->
    <div style="padding: 15px;font-size: 15px;">
        <div class="layui-input-block" style="margin-right: 25px;margin-left: 65px;color: white;text-align: center;">
            <h2>服刑人员劳动报酬管理</h2>
        </div>
        <div class="layui-input-block" style="margin-right: 25px;margin-left: 65px;">

        <table class="layui-hide" id="test" lay-filter="test" ></table>
        </div>
     <script type="text/html" id="toolbarDemo">
      
        <div class="layui-input-block" style="position: absolute;left: -90px;top:9px">
            <input type="search" name="search" id="search" placeholder="输入姓名进行搜索" autocomplete="on" class="layui-input" style="height:33px;width:300px;" >
        </div>  
        <div class="layui-input-block" lay-event="getsearch" style="position: absolute;left: 220px;top: 9px;">
            <input id="do_search" type="submit" value="查找" class="layui-btn layui-btn-sm" lay-event="getsearch" style="width: 100px;text-align: center;"> 
        </div > 
        
        <div class="layui-btn-container" style="position:absolute;left:440px">
        <button class="layui-btn layui-btn-sm" lay-event="getCheckLength">获取选中数目</button>
        </div>
        
        <div class="layui-input-block" lay-event="getsearch" style="position: absolute;left: 430px;top: 9px;">
          <input id="do_search" type="submit" value="开始劳动" class="layui-btn layui-btn-sm" lay-event="getStartWork" style="width: 100px;text-align: center;"> 
      </div > 

      <div class="layui-input-block" lay-event="getsearch" style="position: absolute;left:540px;top: 9px;">
        <input id="do_search" type="submit" value="结束劳动" class="layui-btn layui-btn-sm" lay-event="getEndWork" style="width: 100px;text-align: center;"> 
    </div > 
       </script>
         <script type="text/html" id="barDemo">
            <a class="layui-btn layui-btn-xs" lay-event="edit">申请请假</a>
            <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除信息</a>
          </script>
           
          <script>
          layui.use('table', function(){
            var table = layui.table;

             table.render({
              elem: '#test'
              ,url:'../Code/showSalary.php'
              ,id:'t'
              ,toolbar: '#toolbarDemo' //开启头部工具栏，并为其绑定左侧模板
              ,defaultToolbar: ['filter', 'exports', 'print', { //自定义头部工具栏右侧图标。如无需自定义，去除该参数即可
                title: '提示'
                ,layEvent: 'LAYTABLE_TIPS'
                ,icon: 'layui-icon-tips'
              }]
              ,title: '服刑人员劳动报酬表'
              ,width: 1022              
              ,height:505
              ,cols: [[
                {type: 'checkbox', fixed: 'left'}
                ,{field:'FID', title:'ID', width:130, fixed: 'left', unresize: false, sort: true}
                ,{field:'FName', title:'姓名', width:130,}
                ,{field:'FAge', title:'年龄', width:130,  sort: true}
                ,{field:'FComeTime', title:'入狱时间', width:130,sort: true}
                ,{field:'FWorkTime', title:'工作时长(时）', width:135,sort: true,edit: 'text'}
                ,{field:'FSalary', title:'工资', width:130, sort: true, edit: 'text'}
                ,{fixed: 'right', title:'操作', toolbar: '#barDemo', width:162}
              ]]
              ,page: true
              ,limit:10
            });
   
  

            
            //头工具栏事件
            table.on('toolbar(test)', function(obj){
              var checkStatus = table.checkStatus(obj.config.id);
              switch(obj.event){
                case 'getCheckData':
                  var data = checkStatus.data;
                  layer.alert(JSON.stringify(data));
                break;
                case 'getCheckLength':
                  var data = checkStatus.data;
                  layer.msg('选中了：'+ data.length + ' 个');
                break;
                case 'getsearch':
                var $ = layui.$, active = {
    reload: function(){
      var demoReload = $('#search');
      
      //执行重载
      table.reload('t', {
        page: {
          curr: 1 //重新从第 1 页开始
        }
        ,where: {
          key: {
           FID: demoReload.val()
          }
        }
      }, 'data');
    }
  };
  $('#do_search').on('click', function(){
    var type = $(this).data('type');
    active[type] ? active[type].call(this) : '';
  });
                break;
                
                //自定义头工具栏右侧图标 - 提示   
                case 'LAYTABLE_TIPS':
                  layer.msg('详细说明请阅读使用文档');
                break;
              };
            });
            
            //监听行工具事件
            table.on('tool(test)', function(obj){
              var data = obj.data;
              console.log(data);
              if(obj.event === 'del'){
                layer.confirm('真的删除行么', function(index){
                  obj.del();
                  layer.close(index);
                  $.ajax({
                      method:"POST",
                      url:"../Code/tableDelete.php",
                      data:{
                          data
                      },
                      success:function(result){   
                          var mes = JSON.parse(result);
                          layer.msg(mes.message,{icon:1});
                      },
                      error:function(msg){
                          alert(result);
                      }
                  })
                });
              } else if(obj.event === 'edit'){
                layer.prompt({
                  formType: 2
                  ,value: data.email
                }, function(value, index){
                  obj.update({
                    email: value
                  });
                  layer.close(index);
                });
              }
            });
          });
          </script>
          <script>
            layui.use('table', function(){
              var table = layui.table;
              
              //监听单元格编辑
              table.on('edit(test3)', function(obj){
                var value = obj.value //得到修改后的值
                ,data = obj.data //得到所在行所有键值
                ,field = obj.field; //得到字段
                layer.msg('[ID: '+ data.id +'] ' + field + ' 字段更改为：'+ value);
              });
            });
            </script>
    </div>
  
  </div>

  
  <div class="layui-footer" style="background: rgba(0,0,0,0);text-align: right;height: 35px;">
    <!-- 底部固定区域 -->
    Copy Right @xincl7@163.com
  </div>
</div>

<script>
//JavaScript代码区域
layui.use('element', function(){
  var element = layui.element;
  
});
</script>
</body>
</html>